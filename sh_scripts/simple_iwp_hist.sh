#!/bin/bash
#SBATCH --job-name=iwpsimple
#SBATCH --partition=shared
#SBATCH --mem=10GB
#SBATCH --time=01:00:00
#SBATCH --mail-type=FAIL
#SBATCH --mail-user=smturbev@uw.edu
#SBATCH --account=bb1153
#SBATCH --output=out%j.eo
#SBATCH --error=err_iwphist%j.eo

set -evx # verbose messages and crash message
twp=/work/bb1153/b380883/TWP
gt=/work/bb1153/b380883/GT
scr=/scratch/b/b380883

iwp_file=$scr/2009_02_full_tropics.nc
iwp_hist_file=$gt/GT_DARDAR_fromASokol_iwp_hist_20090205.nc
# iwp_file=$gt/GT_IFSr1deg_clivi_20200130-20200228.nc
# iwp_hist_file=$gt/GT_IFSr1deg_iwp_hist_20200130-20200228.nc
# iwp_file=$gt/GT_SAMr1deg_iwp_20200130-20200228.nc
# iwp_hist_file=$gt/GT_SAMr1deg_iwp_hist_20200130-20200228.nc
# iwp_file=$gt/GT_UMr1deg_clivi_20200130-20200228.nc
# iwp_hist_file=$gt/GT_UMr1deg_iwp_hist_20200130-20200228.nc
# iwp_file=$gt/GT_SCREAMr1deg_clivi_20200130-20200228.nc
# iwp_hist_file=$gt/GT_SCREAMr1deg_iwp_hist_20200130-20200228.nc
# # iwp_file=$gt/GT_SHiELDr1deg_iwp_20200130-20200228.nc
# iwp_hist_file=$gt/GT_SHiELDr1deg_iwp_hist_20200130-20200228.nc
# iwp_file=$gt/GT_ICONr1deg_iwp_20200130-20200228.nc
# iwp_hist_file=$gt/GT_ICONr1deg_iwp_hist_20200130-20200228.nc
# iwp_file=$gt/GT_GEOSr1deg_iwp_20200130-20200228.nc
# iwp_hist_file=$gt/GT_GEOSr1deg_iwp_hist_20200130-20200228.nc

# done for GEOS, ICON, SHiELD

# bins=1.00000000e-07,1.88739182e-07,3.56224789e-07,6.72335754e-07,1.26896100e-06,2.39502662e-06,4.52035366e-06, 8.53167852e-06,1.61026203e-05,3.03919538e-05,5.73615251e-05,1.08263673e-04,2.04335972e-04,3.85662042e-04,7.27895384e-04, 1.37382380e-03,2.59294380e-03,4.89390092e-03,9.23670857e-03,1.74332882e-02,3.29034456e-02,6.21016942e-02,1.17210230e-01, 2.21221629e-01,4.17531894e-01,7.88046282e-01,1.48735211e+00,2.80721620e+00,5.29831691e+00,1.00000000e+01
# bins=0.0000001,0.000000188739182,0.000000356224789,0.000000672335754,0.00000126896100,0.00000239502662,0.00000452035366, 0.0000085316785,0.0000161026203,0.0000303919538,0.0000573615251,0.000108263673,0.000204335972,0.000385662042,0.000727895384, 0.00137382380,0.00259294380,0.00489390092,0.00923670857,0.0174332882,0.0329034456,0.0621016942,0.117210230, 0.221221629,0.417531894,0.788046282,1.48735211,2.80721620,5.29831691,10


cdo -setname,"iwp" -histcount,0.0000001,0.000000188739182,0.000000356224789,0.000000672335754,0.00000126896100,0.00000239502662,0.00000452035366,0.0000085316785,0.0000161026203,0.0000303919538,0.0000573615251,0.000108263673,0.000204335972,0.000385662042,0.000727895384,0.00137382380,0.00259294380,0.00489390092,0.00923670857,0.0174332882,0.0329034456,0.0621016942,0.117210230,0.221221629,0.417531894,0.788046282,1.48735211,2.80721620,5.29831691,10 -divc,1000 -selvar,"iwp" $iwp_file $iwp_hist_file
